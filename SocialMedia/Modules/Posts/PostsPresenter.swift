//
//  PostsPresenter.swift
//  SocialMedia
//
//  Created by Okhan Okbay on 26.12.2020.
//  Copyright (c) 2020 ___ORGANIZATIONNAME___. All rights reserved.
//
//  This file was generated by the 🐍 VIPER generator
//

import Foundation

final class PostsPresenter {

    // MARK: - Private properties -

    private unowned let view: PostsViewInterface
    private let interactor: PostsInteractorInputInterface
    private let router: PostsRouterInterface
    
    // MARK: - Lifecycle -

    init(view: PostsViewInterface,
         interactor: PostsInteractorInputInterface,
         router: PostsRouterInterface) {
        
        self.view = view
        self.interactor = interactor
        self.router = router
    }
}

// MARK: - Extensions -

extension PostsPresenter: PostsPresenterInterface {
    func viewDidLoad() {
        view.setTitle(Strings.PostsPage.title.rawValue)
        view.showProgressHUD()
        
        interactor.getPosts()
    }
    
    func numberOfItems() -> Int {
        return interactor.getNumberOfItems()
    }
    
    func item(at index: Int) -> MultiPurposeTableCellViewModelable {
        let post = interactor.getItem(at: index)
        return MultiPurposeTableCellViewModel(firstText: post.title, disclosureIndicatorType: .normal)
    }
    
    func didSelectItem(at index: Int) {
        let dataProvider = interactor.getDataProvider()
        let post = interactor.getItem(at: index)
        router.navigateToPostDetail(with: dataProvider, post: post)
    }
}

extension PostsPresenter: PostsInteractorOutputInterface {
    func postsReceived() {
        DispatchQueue.main.async {
            self.view.hideProgressHUD()
            self.view.reloadInterface()
        }
    }
}
